plot(post.re, plotfun="trace", inc_warmup = TRUE)
stan_ac(post.re,inc_warmup = FALSE, lags = 25)
plot(post.re, plotfun = "hist", pars = c("alpha","beta"),bins=50)
plot(post.re, plotfun = "hist", pars = c("e"),bins=50)
samples=as.matrix(post.re)
samples
length(areas)
length(area)
unique(area)
length(unique(area))
data.stan <- list ("n"=length(y),"d"=dim(X)[2], "y"=y, "X"=X, "NA"=length(unique(area)), "A_ind"=area)   # no vegetation data
post.re=stan(model_code=whitefish.model.re,data=data.stan,
warmup=200,iter=400,chains=3)
print(post.re)  #pars=c("s","mu"),
plot(post.re, plotfun="trace", inc_warmup = TRUE)
stan_ac(post.re,inc_warmup = FALSE, lags = 25)
plot(post.re, plotfun = "hist", pars = c("e"),bins=50)
# Vector of area indexes. Let's change the area names to numerical area codes.
area = as.numeric(factor(data$AREANAME))
par(mfrow=c(1,3))
X[,1:2] = (X[,1:2]-t(replicate(dim(X)[1],mx)))/t(replicate(dim(X)[1],stdx))
knitr::opts_chunk$set(echo = TRUE)
# Read the data
data = read.csv("white_fishes_data.csv")
# Vector of area indexes. Let's change the area names to numerical area codes.
area = as.numeric(factor(data$AREANAME))
# Let's then take the covariates to matrix X and standardize them
X = data[,c("DIS_SAND","ICELAST09","BOTTOMCOV")]
# And for last let's take the presence-absence observations of white fish larvae into Y
y = data$WHIBIN
par(mfrow=c(1,3))
hist(X$DIS_SAND)
hist(X$ICELAST09)
hist(X$BOTTOMCOV)
mx = colMeans(X[,1:2])
stdx = apply(X[,1:2],2,sd)
X[,1:2] = (X[,1:2]-t(replicate(dim(X)[1],mx)))/t(replicate(dim(X)[1],stdx))
library(ggplot2)
library(StanHeaders)
library(rstan)
library(gridExtra)
library(see)
options(mc.cores = parallel::detectCores())
rstan_options(auto_write = TRUE)
set.seed(123)
whitefish.model = "data{
int<lower=0> n;       // number of sampling sites
int<lower=0> d;       // number of covariates
int<lower=0> y[n];    // white fish presence/absence per site
matrix[n,d] X;          // matrix of covariates
}
parameters{
vector[d] beta;
real alpha;
}
model{
beta ~ normal(0,sqrt(10);
alpha ~ normal(0,sqrt(10));
y ~ bernoulli_logit(alpha + X*beta);
// Note that the above line is the same as follows
// for( i in 1 : n ){
//  y[i] ~ bernoulli_logit(alpha + X[i,]*beta);
//}
}"
library(ggplot2)
library(StanHeaders)
library(rstan)
library(gridExtra)
library(see)
options(mc.cores = parallel::detectCores())
rstan_options(auto_write = TRUE)
set.seed(123)
whitefish.model = "data{
int<lower=0> n;       // number of sampling sites
int<lower=0> d;       // number of covariates
int<lower=0> y[n];    // white fish presence/absence per site
matrix[n,d] X;        // matrix of covariates
}
parameters{
vector[d] beta;
real alpha;
}
model{
beta ~ normal(0,sqrt(10);
alpha ~ normal(0,sqrt(10));
y ~ bernoulli_logit(alpha + X*beta);
// Note that the above line is the same as follows
// for( i in 1 : n ){
//  y[i] ~ bernoulli_logit(alpha + X[i,]*beta);
//}
}"
data.stan <- list ("n"=length(y),"d"=dim(X)[2], "y"=y, "X"=X)   # no vegetation data
post=stan(model_code=whitefish.model,data=data.stan,
warmup=200,iter=400,chains=3)
library(ggplot2)
library(StanHeaders)
library(rstan)
library(gridExtra)
library(see)
options(mc.cores = parallel::detectCores())
rstan_options(auto_write = TRUE)
set.seed(123)
whitefish.model = "data{
int<lower=0> n;       // number of sampling sites
int<lower=0> d;       // number of covariates
int<lower=0> y[n];    // white fish presence/absence per site
matrix[n,d] X;        // matrix of covariates
}
parameters{
vector[d] beta;
real alpha;
}
model{
beta ~ normal(0,sqrt(10));
alpha ~ normal(0,sqrt(10));
y ~ bernoulli_logit(alpha + X*beta);
// Note that the above line is the same as follows
// for( i in 1 : n ){
//  y[i] ~ bernoulli_logit(alpha + X[i,]*beta);
//}
}"
data.stan <- list ("n"=length(y),"d"=dim(X)[2], "y"=y, "X"=X)   # no vegetation data
post=stan(model_code=whitefish.model,data=data.stan,
warmup=200,iter=400,chains=3)
samples <- as.matrix(post)   # combine all chains into one matrix in R workspace
cor(samples[,"beta[3]"],samples[,"alpha"])
rm(list=ls())
library(ggplot2)
library(gridExtra)
library(see)
ship_IC = "C"
oil_type = "O2"
species = "polar_bear"
season = "spring"
routes = c("t0","t1","t2","t4","t6")
nsample = 100
route = "t0"
data_wd = "~/Documents_extended/Projects_data/LRF/Combined_analysis/Jussin_materiaalit/Results/"
i1=1
years = 2009:2013
if (season == "winter") {
years.rep = c(t(replicate(years,n = 3))  )
months.rep = c(replicate(c(12,1,2),n=length(years)))
years.rep[months.rep==12] = years.rep[months.rep==12]-1
} else if (season == "spring"){
years.rep = c(t(replicate(years,n = 4))  )
months.rep = c(replicate(c(3,4,5,6),n=length(years)))
} else if (season == "summer") {
years.rep = c(t(replicate(years,n = 3))  )
months.rep = c(replicate(c(7,8,9),n=length(years)))
} else if (season == "autumn") {
years.rep = c(t(replicate(years,n = 2))  )
months.rep = c(replicate(c(10,11),n=length(years)))
}
# Define colors
rbPal <- colorRampPalette(c('blue',"yellow",'red'))
Cols <- rbPal(length(years.rep))
par(mfrow=c(3,2))
relPop_overRoutes = array(NA, dim=c(length(routes),length(years.rep),nsample))
for (r1 in 1:length(routes)){
for (y1 in 1:length(years.rep)){
scenario = paste0(data_wd,
"Ship",
ship_IC, "_",
oil_type, "_",
species, "_",
years.rep[y1], "_",
months.rep[y1], "_",
routes[r1])
relPop = read.table(paste0(scenario, "_relPop.txt"), header=FALSE, sep=",")
relPop_overRoutes[r1,y1,] = colSums(relPop)
relPop.q = apply(relPop,1,quantile,probs = c(0.1,0.5,0.9))
relPop.q = log10(relPop.q)
distance = seq(1,dim(relPop)[1])*5
if (y1==1){
plot(distance, relPop.q[2,], type="l",
ylab="Proportion of population at risk", xlab="distance, km",
main=paste0("route ",routes[r1], ", ", season, ", ", species),
xlim = c(0,300*5)    ,
ylim = c(-4.2,-2.5),
col=Cols[y1])
} else{
lines(distance, relPop.q[2,], type="l", col=Cols[y1])
}
}
}
# Total risk over the routes
par(mfrow=c(2,2))
hist(log10(relPop_overRoutes[1,,]))
temp = log10(relPop_overRoutes[1,,])
hist(temp[sample(1:prod(dim(temp)),100)])
hist(log10(relPop_overRoutes[1,1,]))
hist(log10(relPop_overRoutes[1,2,]))
ind1 = sample(1:dim(relPop_overRoutes)[2],100,replace=TRUE)
plot(relPop_overRoutes[1,ind1,1:100], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim = c(min(relPop_overRoutes),max(relPop_overRoutes)))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(relPop_overRoutes[1,i1],relPop_overRoutes[3,i1]), col="blue")
}
dim(relPop_overRoutes)
dim(relPop_overRoutes[1,ind1,1:100])
dim(relPop_overRoutes)[1])
dim(relPop_overRoutes)[1])
dim(relPop_overRoutes)[1])
dim(relPop_overRoutes)[1]
dim(relPop_overRoutes)
prod(dim(relPop_overRoutes[1,,])
)
dim(relPop_overRoutes[1,,])
ind = sample(1:prod(dim(relPop_overRoutes[1,,])),100)
ind
relPop_overRoutes_margIce = matrix(dim(relPop_overRoutes)[1,3])
relPop_overRoutes_margIce = matrix(NA,nrow=dim(relPop_overRoutes)[1],ncol=dim(relPop_overRoutes)[1])
dim(relPop_overRoutes_margIce)
relPop_overRoutes_margIce = matrix(NA,nrow=dim(relPop_overRoutes)[1],ncol=dim(relPop_overRoutes)[3])
dim(relPop_overRoutes_margIce)
i1=1
temp = log10(relPop_overRoutes[i1,,])
temp
dim(temp)
relPop_overRoutes_margIce = temp(ind)
relPop_overRoutes_margIce[i1,] = temp(ind)
ind = sample(1:prod(dim(relPop_overRoutes[1,,])),100)
for (i1 in 1:dim(relPop_overRoutes)[1]){
temp = log10(relPop_overRoutes[i1,,])
relPop_overRoutes_margIce[i1,] = temp[ind]
}
dim(relPop_overRoutes_margIce)
apply(relPop_overRoutes_margIce,1,quantile,probs=c(0.1,0.5,0.9))
dim(relPop_overRoutes)
dim(relPop_overRoutes[,1,])
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim = c(min(relPop_overRoutes),max(relPop_overRoutes)))
q.marg = apply(relPop_overRoutes_margIce,1,quantile,probs=c(0.1,0.5,0.9))
q.month1 = apply(relPop_overRoutes[,1,],1,quantile,probs=c(0.1,0.5,0.9))
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim = c(min(relPop_overRoutes),max(relPop_overRoutes)))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species))
[1:5]
seq(1,5,1)
seq(1,5,1)-0.2
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
q.month1[2,]
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(g.marg),max(q.marg)))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)))
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
}
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
q.month1
# Total risk over routes marginalized over months and
# for few example months
ind = sample(1:prod(dim(relPop_overRoutes[1,,])),100)
relPop_overRoutes_margIce = matrix(NA,nrow=dim(relPop_overRoutes)[1],ncol=dim(relPop_overRoutes)[3])
for (i1 in 1:dim(relPop_overRoutes)[1]){
temp = relPop_overRoutes[i1,,]
relPop_overRoutes_margIce[i1,] = temp[ind]
}
par(mfrow=c(1,1))
q.marg = apply(relPop_overRoutes_margIce,1,quantile,probs=c(0.1,0.5,0.9))
q.month1 = apply(relPop_overRoutes[,1,],1,quantile,probs=c(0.1,0.5,0.9))
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
}
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
q.month1
# Total risk over routes marginalized over months and
# for few example months
ind = sample(1:prod(dim(relPop_overRoutes[1,,])),1000)
relPop_overRoutes_margIce = matrix(NA,nrow=dim(relPop_overRoutes)[1],ncol=dim(relPop_overRoutes)[3])
for (i1 in 1:dim(relPop_overRoutes)[1]){
temp = relPop_overRoutes[i1,,]
relPop_overRoutes_margIce[i1,] = temp[ind]
}
par(mfrow=c(1,1))
q.marg = apply(relPop_overRoutes_margIce,1,quantile,probs=c(0.1,0.5,0.9))
q.month1 = apply(relPop_overRoutes[,1,],1,quantile,probs=c(0.1,0.5,0.9))
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
}
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
dim(relPop_overRoutes_margIce)
id
ind
# Total risk over routes marginalized over months and
# for few example months
ind = sample(1:prod(dim(relPop_overRoutes[1,,])),1000)
relPop_overRoutes_margIce = matrix(NA,nrow=dim(relPop_overRoutes)[1],ncol=length(ind))
for (i1 in 1:dim(relPop_overRoutes)[1]){
temp = relPop_overRoutes[i1,,]
relPop_overRoutes_margIce[i1,] = temp[ind]
}
par(mfrow=c(1,1))
q.marg = apply(relPop_overRoutes_margIce,1,quantile,probs=c(0.1,0.5,0.9))
q.month1 = apply(relPop_overRoutes[,1,],1,quantile,probs=c(0.1,0.5,0.9))
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
}
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
q.marg = apply(relPop_overRoutes,1,quantile,probs=c(0.1,0.5,0.9))
q.month1 = apply(relPop_overRoutes[,1,],1,quantile,probs=c(0.1,0.5,0.9))
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
}
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
q.marg
q.marg = apply(relPop_overRoutes_margIce,1,quantile,probs=c(0.05,0.5,0.95))
q.month1 = apply(relPop_overRoutes[,1,],1,quantile,probs=c(0.1,0.5,0.9))
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
}
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
q.month1
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="blue",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="blue")
}
points(seq(1,5,1)-0.2,q.month1[2,],pch=16)
points(seq(1,5,1)+0.1,q.month2[2,],pch=16)
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="black", cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey")
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", cex=5)
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", cex=5)
}
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=5)
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="black", pch=3 cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="black", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="black", pch=3, cex=5, col="grey",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="black", pch=3, cex=5, col="grey",
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="grey", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.month1[1,i1],q.marg[3,i1]), col="blue", lwd=10)
lines(c(i1,i1),c(q.month2[1,i1],q.marg[3,i1]), col="blue", lwd=10)
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="grey", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
for (i1 in 1:length(routes)){
lines(c(i1,i1)-0.1,c(q.month1[1,i1],q.marg[3,i1]), col="blue")
lines(c(i1,i1)+0.1,c(q.month2[1,i1],q.marg[3,i1]), col="blue")
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="grey", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
for (i1 in 1:length(routes)){
lines(c(i1,i1)-0.1,c(q.month1[1,i1],q.month1[3,i1]), col="blue")
lines(c(i1,i1)+0.1,c(q.month2[1,i1],q.month2[3,i1]), col="blue")
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="grey", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.5,5.5))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
for (i1 in 1:length(routes)){
lines(c(i1,i1)-0.1,c(q.month1[1,i1],q.month1[3,i1]), col="blue")
lines(c(i1,i1)+0.1,c(q.month2[1,i1],q.month2[3,i1]), col="red")
}
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="grey", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.8,5.2))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
for (i1 in 1:length(routes)){
lines(c(i1,i1)-0.1,c(q.month1[1,i1],q.month1[3,i1]), col="blue")
lines(c(i1,i1)+0.1,c(q.month2[1,i1],q.month2[3,i1]), col="red")
}
dim(q.month2)
q.marg=log10(q.marg)
q.month1=log10(q.month1)
q.month2=log10(q.month2)
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="grey", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.8,5.2))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
for (i1 in 1:length(routes)){
lines(c(i1,i1)-0.1,c(q.month1[1,i1],q.month1[3,i1]), col="blue")
lines(c(i1,i1)+0.1,c(q.month2[1,i1],q.month2[3,i1]), col="red")
}
q.marg = apply(relPop_overRoutes_margIce,1,quantile,probs=c(0.05,0.5,0.95))
q.month1 = apply(relPop_overRoutes[,1,],1,quantile,probs=c(0.1,0.5,0.9))
q.month2 = apply(relPop_overRoutes[,10,],1,quantile,probs=c(0.1,0.5,0.9))
# q.marg=log10(q.marg)
# q.month1=log10(q.month1)
# q.month2=log10(q.month2)
plot(q.marg[2,], ylab="relative population in oiled area", xlab="route", col="grey", pch=3, cex=5,
main=paste0(season, ", ", species),
ylim=c(min(q.marg),max(q.marg)),
xlim=c(0.8,5.2))
for (i1 in 1:length(routes)){
lines(c(i1,i1),c(q.marg[1,i1],q.marg[3,i1]), col="grey", lwd=10)
}
points(seq(1,5,1)-0.1,q.month1[2,],pch=16, col="blue")
points(seq(1,5,1)+0.1,q.month2[2,],pch=16, col="red")
for (i1 in 1:length(routes)){
lines(c(i1,i1)-0.1,c(q.month1[1,i1],q.month1[3,i1]), col="blue")
lines(c(i1,i1)+0.1,c(q.month2[1,i1],q.month2[3,i1]), col="red")
}
apply(relPop_overRoutes,c(1,2),quantile,probs=c(0.1,0.5,0.9))
q.months = apply(relPop_overRoutes,c(1,2),quantile,probs=c(0.1,0.5,0.9))
dim(relPop_overRoutes_margIce)
apply(relPop_overRoutes_margIce,1,var)
apply(relPop_overRoutes_margIce,1,var)
plot(apply(relPop_overRoutes_margIce,1,var))
barplot(apply(relPop_overRoutes_margIce,1,var))
dim(q.months)
apply(relPop_overRoutes_margIce,1,var)
q.months[2,]
q.months[2,,]
apply(q.months[2,,],1,var)
barplot(temp)
temp=table(apply(relPop_overRoutes_margIce,1,var),apply(q.months[2,,],1,var))
barplot(temp)
temp
?table
